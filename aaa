# Query Image
query:
  image_width: 640
  image_height: 480
  enable_image_rotation: true
  downscale_factor: 1.0

subscribe:
  #image_topic: "/iris/usb_cam/image_raw"
  image_topic: "/camera/image_raw"
  gps_topic: "/mavros/global_position/global"
  local_topic: "/mavros/local_position/pose"
  home_position_topic: "/mavros/home_position/home"
  rotation_angle_topic: "/mavros/global_position/compass_hdg"  

publish:
  local_vision_topic: "/mavros/vision_pose/pose"
  global_vision_topic: "/mavros/gpsstatus/gps1/raw_"
  navsat_topic: "~geo_pose_navsat"



kalman_estimator:
  timer: 250 # Timer in milliseconds for Kalman filter updates
  use_kalman_filter: true # Enable Kalman filter for state estimation

  
# DB Query Parameters
db:
  radius_m: 100.0
  use_last_pose_for_query: true

  # Db Connection Parameters
  name: "geospatial_db_polatli"
  host: "localhost"
  port: 5432
  user: "gornav"
  password: "gornav"

# # UTM Configuration (CRITICAL: Set for your operational area)
# utm:
#   zone_number: 36  # Example: 30 for parts of UK/Europe
#   zone_letter: "U" # Example: U for Northern Hemisphere

# Feature Extractor and Matcher
features:
  extractor_type: "aliked" # "aliked", "superpoint", or "disk"
  max_keypoints: 1024
  detection_threshold: 0.01 # For ALIKED:0.90/SuperPoint:0.01

# Homography RANSAC
ransac_homography:
  threshold_px: 5.0
  min_raw_matches: 10


# Camera Intrinsics (CRITICAL: Calibrate your camera!)
camera:
  fx: 344.4698756955504
  fy: 345.54729023658206
  cx: 326.50055610816605
  cy: 264.41112901716741  
  # Distortion coefficients [k1, k2, p1, p2, k3]
  distortion_coeffs: [-0.32077470636977023, 0.12335327115083677, 0, 0, -0.024282788320832371] # MUST BE FROM CALIBRATION

pnp_ransac:
  min_inliers: 15
  iterations_count: 100
  reprojection_error_px: 8.0
  confidence: 0.99
  method_flag: "SOLVEPNP_ITERATIVE" # OpenCV PnP flag e.g., SOLVEPNP_ITERATIVE, SOLVEPNP_P3P, SOLVEPNP_AP3P, SOLVEPNP_SQPNP

# World Frame ID
world_frame_id: "map"

camera_to_imu_orientation_vec: [0, 0, -90]   #from camera to imu orientation_vector

initial_coordinates:
  start_lat: 39.76976482
  start_lon: 32.04822142
  start_alt: 803  # in meters above sea level
  start_HAE: 33  # in meters above earth level
  start_heading: 0     #rotation from north 
  allow_update_by_mavros: true #when true system will startup with start values and will be updated when ever a related mavros messages i≈üs received.
  force_update_by_macros: false # when true the initial coordinates are discarded, and the initial data expected from mavros
  use_start_pose_as_home_postion: true # when false we force home postion to come from mavros

debug:
  enable: False
  log_level: "DEBUG" # Options: DEBUG, INFO, WARN, ERROR, FATAL
  log_file: "/tmp/visual_localizer_debug.log" # Not used in ROS
